# Mentorium Chat Bot - –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

Telegram-–±–æ—Ç –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã Mentorium, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–≥–∞–µ—Ç —Ä–æ–¥–∏—Ç–µ–ª—è–º –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å —Å–≤–æ–∏—Ö –¥–µ—Ç–µ–π –≤ –æ–±—É—á–µ–Ω–∏–∏. –ë–æ—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç AI-–¥–∏–∞–ª–æ–≥–∏ —Å –Ω–∞—Å—Ç–∞–≤–Ω–∏–∫–æ–º, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç—á—ë—Ç—ã –æ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ, —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–¥–ø–∏—Å–∫–∞–º–∏ –∏ –ø–ª–∞—Ç–µ–∂–∞–º–∏.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω –∫–∞–∫ **–º–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π** (–≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –≤ –æ–¥–Ω–æ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **Poetry** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏.

```
Mentorium-Chat-Bot/
‚îú‚îÄ‚îÄ apps/                    # –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è (—Å–µ—Ä–≤–∏—Å—ã)
‚îú‚îÄ‚îÄ packages/                # –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
‚îú‚îÄ‚îÄ docs/                    # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ scripts/                 # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
‚îú‚îÄ‚îÄ tests/                   # –¢–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ docker-compose.yml       # –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
‚îú‚îÄ‚îÄ Dockerfile              # –°–±–æ—Ä–∫–∞ Docker-–æ–±—Ä–∞–∑–∞
‚îú‚îÄ‚îÄ Makefile                # –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
‚îî‚îÄ‚îÄ pyproject.toml          # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π

### `/apps` - –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–û—Å–Ω–æ–≤–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã –ø—Ä–æ–µ–∫—Ç–∞:

#### 1. **telegram_bot** - Telegram –±–æ—Ç (–æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å)
```
apps/telegram_bot/mentorium_bot/
‚îú‚îÄ‚îÄ handlers/              # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ –∏ —Å–æ–±—ã—Ç–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ start.py          # /start, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ dialog.py         # AI-–¥–∏–∞–ª–æ–≥–∏ —Å –Ω–∞—Å—Ç–∞–≤–Ω–∏–∫–æ–º
‚îÇ   ‚îú‚îÄ‚îÄ report.py         # –ó–∞–ø—Ä–æ—Å –æ—Ç—á—ë—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ billing.py        # –ü–æ–¥–ø–∏—Å–∫–∏ –∏ —Ç–∞—Ä–∏—Ñ—ã
‚îÇ   ‚îî‚îÄ‚îÄ webhooks.py       # –í–µ–±—Ö—É–∫–∏ –æ—Ç –ø–ª–∞—Ç—ë–∂–Ω—ã—Ö —Å–∏—Å—Ç–µ–º
‚îú‚îÄ‚îÄ middleware/            # –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ subscription.py   # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏
‚îú‚îÄ‚îÄ services/              # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ ai_dialog_service.py      # –†–∞–±–æ—Ç–∞ —Å AI (OpenAI)
‚îÇ   ‚îú‚îÄ‚îÄ billing_service.py        # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏
‚îÇ   ‚îî‚îÄ‚îÄ payment/                  # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø–ª–∞—Ç—ë–∂–∫–∞–º–∏
‚îÇ       ‚îú‚îÄ‚îÄ payme.py             # PayMe (–£–∑–±–µ–∫–∏—Å—Ç–∞–Ω)
‚îÇ       ‚îú‚îÄ‚îÄ click.py             # Click (–£–∑–±–µ–∫–∏—Å—Ç–∞–Ω)
‚îÇ       ‚îî‚îÄ‚îÄ telegram_stars.py    # Telegram Stars
‚îú‚îÄ‚îÄ states/                # FSM —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è –¥–∏–∞–ª–æ–≥–æ–≤
‚îú‚îÄ‚îÄ config.py             # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞ (–∏–∑ .env)
‚îú‚îÄ‚îÄ main.py               # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ (polling)
‚îî‚îÄ‚îÄ webhook_app.py        # FastAPI –¥–ª—è webhooks (–ø–æ—Ä—Ç 8001)
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –∫–æ–º–∞–Ω–¥—ã –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ Telegram
- –û–±—â–∞–µ—Ç—Å—è —Å OpenAI –¥–ª—è AI-–¥–∏–∞–ª–æ–≥–æ–≤
- –£–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–¥–ø–∏—Å–∫–∞–º–∏ (—Å–æ–∑–¥–∞–Ω–∏–µ, –ø—Ä–æ–¥–ª–µ–Ω–∏–µ, –æ—Ç–º–µ–Ω–∞)
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç webhooks –æ—Ç –ø–ª–∞—Ç—ë–∂–Ω—ã—Ö —Å–∏—Å—Ç–µ–º (PayMe, Click)
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Ä–æ–¥–∏—Ç–µ–ª—è–º

**–ó–∞–ø—É—Å–∫:**
```bash
make dev                    # –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
docker-compose up bot       # –í Docker
```

---

#### 2. **reporting_worker** - –§–æ–Ω–æ–≤—ã–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –æ—Ç—á—ë—Ç–æ–≤
```
apps/reporting_worker/mentorium_reporting/
‚îú‚îÄ‚îÄ jobs/                  # –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏
‚îÇ   ‚îú‚îÄ‚îÄ weekly_reports.py  # –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ –æ—Ç—á—ë—Ç—ã (–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ 9:00)
‚îÇ   ‚îî‚îÄ‚îÄ monthly_reports.py # –ï–∂–µ–º–µ—Å—è—á–Ω—ã–µ –æ—Ç—á—ë—Ç—ã (1-–µ —á–∏—Å–ª–æ)
‚îú‚îÄ‚îÄ config.py             # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–æ—Ä–∫–µ—Ä–∞
‚îî‚îÄ‚îÄ main.py               # APScheduler + –∑–∞–¥–∞—á–∏
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –ü–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç—á—ë—Ç—ã –æ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç—á—ë—Ç—ã —Ä–æ–¥–∏—Ç–µ–ª—è–º —á–µ—Ä–µ–∑ Telegram
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç OpenAI –¥–ª—è –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ —Ç–æ–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–π

**–ó–∞–ø—É—Å–∫:**
```bash
python -m mentorium_reporting.main
```

---

### `/packages` - –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

–û–±—â–∏–π –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö:

#### 1. **ai_client** - –ö–ª–∏–µ–Ω—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å OpenAI
```
packages/ai_client/mentorium_ai_client/
‚îú‚îÄ‚îÄ client.py             # –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å MentoriumAIClient
‚îú‚îÄ‚îÄ prompts.py            # –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è AI
‚îî‚îÄ‚îÄ utils.py              # –ü–æ–¥—Å—á—ë—Ç —Ç–æ–∫–µ–Ω–æ–≤, retry-–ª–æ–≥–∏–∫–∞
```

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤ –æ—Ç AI-–Ω–∞—Å—Ç–∞–≤–Ω–∏–∫–∞
- –ü–æ–¥—Å—á—ë—Ç —Ç–æ–∫–µ–Ω–æ–≤ (tiktoken)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–≤—Ç–æ—Ä—ã –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö (tenacity)
- –°—Ç—Ä–∏–º–∏–Ω–≥ –æ—Ç–≤–µ—Ç–æ–≤ –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```python
from mentorium_ai_client import MentoriumAIClient

client = MentoriumAIClient(api_key="sk-...")
reply = await client.generate_reply("–ö–∞–∫ –¥–µ–ª–∞ —Å —É—á—ë–±–æ–π?", user_id=123)
```

---

#### 2. **db** - –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
```
packages/db/mentorium_db/
‚îú‚îÄ‚îÄ models.py             # SQLAlchemy –º–æ–¥–µ–ª–∏ (—Ç–∞–±–ª–∏—Ü—ã)
‚îú‚îÄ‚îÄ session.py            # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
‚îú‚îÄ‚îÄ repositories/         # –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ (DAL - Data Access Layer)
‚îÇ   ‚îú‚îÄ‚îÄ parent.py        # –†–∞–±–æ—Ç–∞ —Å —Ä–æ–¥–∏—Ç–µ–ª—è–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ learner.py       # –†–∞–±–æ—Ç–∞ —Å —É—á–µ–Ω–∏–∫–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ subscription.py  # –ü–æ–¥–ø–∏—Å–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ payment.py       # –ü–ª–∞—Ç–µ–∂–∏
‚îÇ   ‚îú‚îÄ‚îÄ dialog.py        # –ò—Å—Ç–æ—Ä–∏—è AI-–¥–∏–∞–ª–æ–≥–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ notification.py  # –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ platform.py      # –ß—Ç–µ–Ω–∏–µ –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–π –ë–î –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
‚îî‚îÄ‚îÄ alembic/             # –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
    ‚îî‚îÄ‚îÄ versions/        # –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å—Ö–µ–º—ã
```

**–î–≤–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:**

1. **Bot Database** (PostgreSQL) - —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è –ë–î –±–æ—Ç–∞:
   - `parents` - –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–æ–¥–∏—Ç–µ–ª–∏
   - `learners` - –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–µ —É—á–µ–Ω–∏–∫–∏
   - `subscriptions` - –∞–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏
   - `payments` - –∏—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π
   - `dialogs` - –∏—Å—Ç–æ—Ä–∏—è AI-–¥–∏–∞–ª–æ–≥–æ–≤
   - `notifications` - –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
   - `event_logs` - –ª–æ–≥ —Å–æ–±—ã—Ç–∏–π
   - `report_history` - —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Ç—á—ë—Ç—ã

2. **Platform Database** (PostgreSQL, read-only) - –æ—Å–Ω–æ–≤–Ω–∞—è –ë–î –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã:
   - –î–∞–Ω–Ω—ã–µ –æ–± —É—á–µ–Ω–∏–∫–∞—Ö –∏ –∏—Ö –ø—Ä–æ–≥—Ä–µ—Å—Å–µ
   - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤
   - –ö—É—Ä—Å—ã –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```python
from mentorium_db import get_session
from mentorium_db.repositories import ParentRepository

async with get_session() as session:
    repo = ParentRepository(session)
    parent = await repo.get_by_telegram_id(123456789)
```

---

#### 3. **observability** - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```
packages/observability/mentorium_observability/
‚îú‚îÄ‚îÄ logging.py            # –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏ (structlog)
‚îú‚îÄ‚îÄ event_log.py          # –ó–∞–ø–∏—Å—å —Å–æ–±—ã—Ç–∏–π –≤ –ë–î
‚îú‚îÄ‚îÄ sentry_config.py      # –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ (Sentry)
‚îú‚îÄ‚îÄ health.py             # Health checks –¥–ª—è Kubernetes
‚îî‚îÄ‚îÄ metrics.py            # –ú–µ—Ç—Ä–∏–∫–∏ Prometheus
```

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - JSON-–ª–æ–≥–∏ –¥–ª—è ELK/Loki
- **EventLog** - –∑–∞–ø–∏—Å—å –≤–∞–∂–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π –≤ –ë–î (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏, –ø–ª–∞—Ç–µ–∂–∏, –æ—à–∏–±–∫–∏)
- **Sentry** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –æ—à–∏–±–æ–∫ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
- **Health checks** - `/health/live`, `/health/ready`, `/health` –¥–ª—è Kubernetes
- **Prometheus** - –º–µ—Ç—Ä–∏–∫–∏ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π, –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ AI, –ø–ª–∞—Ç–µ–∂–µ–π)

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```python
from mentorium_observability import configure_logging, get_logger, EventLogService

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
configure_logging(level="INFO", json_logs=True, dev_mode=False)

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ª–æ–≥–≥–µ—Ä–∞
logger = get_logger(__name__)
logger.info("user_registered", user_id=123, subscription="monthly")

# –ó–∞–ø–∏—Å—å —Å–æ–±—ã—Ç–∏–π
await EventLogService.log_user_action("registration", user_telegram_id=123)
await EventLogService.log_payment("payment_success", user_telegram_id=123, amount=99000)
```

---

### `/docs` - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

| –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| `PROJECT_OVERVIEW.md` | üìñ –≠—Ç–æ—Ç —Ñ–∞–π–ª - –æ–±—â–∏–π –æ–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞ |
| `PROJECT_COMPLETE.md` | ‚úÖ –ü–æ–ª–Ω–∞—è —Å–≤–æ–¥–∫–∞ –≤—Å–µ—Ö 8 —Ñ–∞–∑ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ |
| `DEPLOYMENT.md` | üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—é –≤ production |
| `PHASE_7_MONITORING.md` | üìä –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è |
| `ERROR_FIXES.md` | üîß –ò—Å—Ç–æ—Ä–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è 73 –æ—à–∏–±–æ–∫ |

---

### `/scripts` - –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã

```
scripts/
‚îú‚îÄ‚îÄ validate_env.py       # –ü—Ä–æ–≤–µ—Ä–∫–∞ .env –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
‚îî‚îÄ‚îÄ verify_setup.py       # –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–ë–î, Redis, Poetry)
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
python scripts/validate_env.py    # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å .env –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º
make validate                      # –¢–æ –∂–µ —á–µ—Ä–µ–∑ Makefile
```

---

### `/tests` - –¢–µ—Å—Ç—ã

```
tests/
‚îî‚îÄ‚îÄ test_parent_repository.py     # –¢–µ—Å—Ç—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è —Ä–æ–¥–∏—Ç–µ–ª–µ–π
```

**–ó–∞–ø—É—Å–∫:**
```bash
make test                 # –í—Å–µ —Ç–µ—Å—Ç—ã
make test-cov            # –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º
pytest tests/            # –ù–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ pytest
```

---

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –°—Ö–µ–º–∞ —Ç–∞–±–ª–∏—Ü (Bot Database)

```sql
-- –†–æ–¥–∏—Ç–µ–ª–∏ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–æ—Ç–∞)
CREATE TABLE parents (
    id SERIAL PRIMARY KEY,
    telegram_id BIGINT UNIQUE NOT NULL,
    email VARCHAR(255),
    phone VARCHAR(50),
    registration_code VARCHAR(10),
    registration_completed BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP DEFAULT NOW()
);

-- –£—á–µ–Ω–∏–∫–∏ (–¥–µ—Ç–∏ —Ä–æ–¥–∏—Ç–µ–ª–µ–π)
CREATE TABLE learners (
    id SERIAL PRIMARY KEY,
    parent_id INTEGER REFERENCES parents(id),
    platform_student_id INTEGER NOT NULL,  -- ID –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–π –ë–î –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
    first_name VARCHAR(100),
    last_name VARCHAR(100),
    added_at TIMESTAMP DEFAULT NOW()
);

-- –ü–æ–¥–ø–∏—Å–∫–∏
CREATE TABLE subscriptions (
    id SERIAL PRIMARY KEY,
    parent_id INTEGER REFERENCES parents(id),
    tariff VARCHAR(20) NOT NULL,  -- monthly, quarterly, annual
    amount DECIMAL(10,2) NOT NULL,
    status VARCHAR(20) DEFAULT 'ACTIVE',  -- ACTIVE, EXPIRED, CANCELLED
    start_date TIMESTAMP NOT NULL,
    expires_at TIMESTAMP NOT NULL,
    auto_renew BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP DEFAULT NOW()
);

-- –ü–ª–∞—Ç–µ–∂–∏
CREATE TABLE payments (
    id SERIAL PRIMARY KEY,
    parent_id INTEGER REFERENCES parents(id),
    subscription_id INTEGER REFERENCES subscriptions(id),
    transaction_id VARCHAR(255) UNIQUE,
    amount DECIMAL(10,2) NOT NULL,
    currency VARCHAR(10) DEFAULT 'UZS',
    provider VARCHAR(50),  -- TELEGRAM_STARS, PAYME, CLICK
    status VARCHAR(20) DEFAULT 'PENDING',  -- PENDING, SUCCESS, FAILED
    external_ref VARCHAR(255),
    created_at TIMESTAMP DEFAULT NOW()
);

-- –ò—Å—Ç–æ—Ä–∏—è AI-–¥–∏–∞–ª–æ–≥–æ–≤
CREATE TABLE dialogs (
    id SERIAL PRIMARY KEY,
    parent_telegram_id BIGINT NOT NULL,
    user_message TEXT,
    ai_reply TEXT,
    tokens_used INTEGER,
    model VARCHAR(50),
    created_at TIMESTAMP DEFAULT NOW()
);

-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
CREATE TABLE notifications (
    id SERIAL PRIMARY KEY,
    parent_telegram_id BIGINT NOT NULL,
    notification_type VARCHAR(50),  -- REPORT, SUBSCRIPTION, ACHIEVEMENT
    message TEXT,
    sent_at TIMESTAMP DEFAULT NOW()
);

-- –õ–æ–≥ —Å–æ–±—ã—Ç–∏–π
CREATE TABLE event_logs (
    id SERIAL PRIMARY KEY,
    event_type VARCHAR(50),     -- USER_ACTION, PAYMENT, ERROR, SYSTEM
    event_name VARCHAR(100),
    user_telegram_id BIGINT,
    metadata JSONB,
    severity VARCHAR(20),
    created_at TIMESTAMP DEFAULT NOW()
);

-- –ò—Å—Ç–æ—Ä–∏—è –æ—Ç—á—ë—Ç–æ–≤
CREATE TABLE report_history (
    id SERIAL PRIMARY KEY,
    parent_telegram_id BIGINT NOT NULL,
    report_type VARCHAR(50),    -- WEEKLY, MONTHLY, ON_DEMAND
    report_period VARCHAR(100),
    content TEXT,
    generated_at TIMESTAMP DEFAULT NOW()
);
```

---

## üí≥ –ü–ª–∞—Ç—ë–∂–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã

#### 1. **Telegram Stars** ‚≠ê
- –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –≤–∞–ª—é—Ç–∞ Telegram
- –°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã
- –ë–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è: ~1 Star = 100 UZS

#### 2. **PayMe** üá∫üáø
- –£–∑–±–µ–∫–∏—Å—Ç–∞–Ω—Å–∫–∞—è –ø–ª–∞—Ç—ë–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–∞—Ä—Ç Uzcard/Humo
- JSON-RPC 2.0 API
- Webhook: `POST /webhooks/payme`

#### 3. **Click** üá∫üáø
- –£–∑–±–µ–∫–∏—Å—Ç–∞–Ω—Å–∫–∞—è –ø–ª–∞—Ç—ë–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
- –î–≤—É—Ö—Ñ–∞–∑–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (prepare ‚Üí complete)
- Webhooks: 
  - `GET /webhooks/click/prepare`
  - `GET /webhooks/click/complete`

### –¢–∞—Ä–∏—Ñ—ã

| –¢–∞—Ä–∏—Ñ | –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | –¶–µ–Ω–∞ | –°–∫–∏–¥–∫–∞ |
|-------|-------------|------|--------|
| **–ú–µ—Å—è—á–Ω–∞—è** | 30 –¥–Ω–µ–π | 99,000 UZS | - |
| **–ö–≤–∞—Ä—Ç–∞–ª—å–Ω–∞—è** | 90 –¥–Ω–µ–π | 249,000 UZS | -17% |
| **–ì–æ–¥–æ–≤–∞—è** | 365 –¥–Ω–µ–π | 899,000 UZS | -25% |

---

## ü§ñ AI-—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

### –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã

–ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–∞–∑–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:

**1. –ù–∞—Å—Ç–∞–≤–Ω–∏–∫ –¥–ª—è —Ä–æ–¥–∏—Ç–µ–ª–µ–π:**
```
–¢—ã - –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –Ω–∞—Å—Ç–∞–≤–Ω–∏–∫ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã Mentorium. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ - –ø–æ–º–æ–≥–∞—Ç—å 
—Ä–æ–¥–∏—Ç–µ–ª—è–º –ø–æ–Ω—è—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –∏—Ö –¥–µ—Ç–µ–π –≤ –æ–±—É—á–µ–Ω–∏–∏ –Ω–µ–π—Ä–æ—Å–µ—Ç—è–º –∏ AI. –û—Ç–≤–µ—á–∞–π 
–¥—Ä—É–∂–µ–ª—é–±–Ω–æ, –Ω–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ. –ò—Å–ø–æ–ª—å–∑—É–π –ø—Ä–æ—Å—Ç—ã–µ —Ç–µ—Ä–º–∏–Ω—ã.
```

**2. –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –æ—Ç—á—ë—Ç–æ–≤:**
```
–°–æ–∑–¥–∞–π –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç –¥–ª—è —Ä–æ–¥–∏—Ç–µ–ª—è –æ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ —Ä–µ–±—ë–Ω–∫–∞. –í–∫–ª—é—á–∏:
- –û—Å–Ω–æ–≤–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
- –û–±–ª–∞—Å—Ç–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
- –ü—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ —ç—Ç–∞–ø—ã
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º

- –•—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 10 —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –∏—Å—Ç–æ—Ä–∏–∏
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–æ 4000 —Ç–æ–∫–µ–Ω–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–µ–∑–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

---

## üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### –¢–∏–ø—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

1. **REPORT** - –û—Ç—á—ë—Ç—ã –æ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ
   - –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ (–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ 9:00)
   - –ï–∂–µ–º–µ—Å—è—á–Ω—ã–µ (1-–µ —á–∏—Å–ª–æ 10:00)
   - –ü–æ –∑–∞–ø—Ä–æ—Å—É (`/report`)

2. **SUBSCRIPTION** - –ü–æ–¥–ø–∏—Å–∫–∞
   - –ò—Å—Ç–µ–∫–∞–µ—Ç —á–µ—Ä–µ–∑ 3 –¥–Ω—è
   - –ò—Å—Ç–µ–∫–ª–∞ (grace period)
   - –ê–≤—Ç–æ–ø—Ä–æ–¥–ª–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ

3. **ACHIEVEMENT** - –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è
   - –ó–∞–≤–µ—Ä—à–∏–ª –∫—É—Ä—Å
   - –ü–æ–ª—É—á–∏–ª 100% –Ω–∞ —Ç–µ—Å—Ç–µ
   - –î–æ—à—ë–ª –¥–æ milestone

4. **REMINDER** - –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è
   - –ù–µ –±—ã–ª–æ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ 7 –¥–Ω–µ–π
   - –ï—Å—Ç—å –Ω–æ–≤—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

5. **PAYMENT** - –ü–ª–∞—Ç–µ–∂–∏
   - –ü–ª–∞—Ç—ë–∂ —É—Å–ø–µ—à–µ–Ω
   - –ü–ª–∞—Ç—ë–∂ –æ—Ç–∫–ª–æ–Ω—ë–Ω
   - –¢—Ä–µ–±—É–µ—Ç—Å—è –æ–ø–ª–∞—Ç–∞

---

## üöÄ –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```bash
# 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/taefednu/Mentorium-Chat-Bot.git
cd Mentorium-Chat-Bot

# 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
poetry install

# 3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –æ–∫—Ä—É–∂–µ–Ω–∏–µ
cp .env.template .env
nano .env  # –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

# 4. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
make migrate

# 5. –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
make dev
```

### Production (Docker Compose)

```bash
# 1. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å .env
cp .env.template .env
nano .env

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
make validate

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
make docker-up

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–¥–æ—Ä–æ–≤—å–µ
make health
```

**–°–µ—Ä–≤–∏—Å—ã:**
- `postgres` - –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL 16
- `redis` - Redis 7 –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
- `bot` - Telegram –±–æ—Ç (polling)
- `webhook` - FastAPI –¥–ª—è webhooks (–ø–æ—Ä—Ç 8001)
- `migrations` - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ

---

## üõ†Ô∏è –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã (Makefile)

```bash
# –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
make dev                  # –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ –ª–æ–∫–∞–ª—å–Ω–æ
make test                 # –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã
make lint                 # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥ (ruff + mypy)
make format               # –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ (black)

# Docker
make docker-build         # –°–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑
make docker-up            # –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
make docker-down          # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
make docker-logs          # –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
make docker-logs-bot      # –õ–æ–≥–∏ —Ç–æ–ª—å–∫–æ –±–æ—Ç–∞

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
make migrate              # –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
make migrate-create       # –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é
make backup-db            # –ë—ç–∫–∞–ø PostgreSQL
make restore-db           # –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ –±—ç–∫–∞–ø–∞

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
make health               # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å health checks
make metrics              # –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –º–µ—Ç—Ä–∏–∫–∏ Prometheus

# –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ
make validate             # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å .env
make deploy               # –ü–æ–ª–Ω—ã–π deploy (validate + build + up + health)
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### Health Checks

- **`GET /health/live`** - Liveness probe (–ø—Ä–æ—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç OK)
- **`GET /health/ready`** - Readiness probe (–ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ë–î)
- **`GET /health`** - –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (–ë–î + Redis + Platform DB)

### Prometheus –º–µ—Ç—Ä–∏–∫–∏

```
# Telegram
telegram_messages_total{message_type="text|command", status="success|error"}
telegram_commands_total{command="start|subscribe|report"}
telegram_active_users

# AI
ai_requests_total{model="gpt-4", status="success|error"}
ai_request_duration_seconds
ai_tokens_used_total{type="input|output"}

# –ü–ª–∞—Ç–µ–∂–∏
payments_total{provider="telegram_stars|payme|click", status="success|failed"}
subscriptions_active{tariff="monthly|quarterly|annual"}

# –°–∏—Å—Ç–µ–º–∞
errors_total{error_type="api|database|payment"}
bot_uptime_seconds
```

### Sentry

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤—Å–µ—Ö –æ—à–∏–±–æ–∫ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º:
- User ID
- Handler name
- Request parameters
- Stack trace

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–µ (–Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—å!):**
- `BOT_TELEGRAM_TOKEN` - —Ç–æ–∫–µ–Ω –±–æ—Ç–∞
- `BOT_OPENAI_API_KEY` - API –∫–ª—é—á OpenAI
- `DB_PASSWORD` - –ø–∞—Ä–æ–ª—å –ë–î
- `REDIS_PASSWORD` - –ø–∞—Ä–æ–ª—å Redis
- `PAYME_SECRET_KEY` - —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á PayMe
- `CLICK_SECRET_KEY` - —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á Click

**–§–∞–π–ª—ã:**
- `.env` - —Ä–µ–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (–≤ `.gitignore`)
- `.env.template` - —à–∞–±–ª–æ–Ω –¥–ª—è production (–±–µ–∑ —Å–µ–∫—Ä–µ—Ç–æ–≤)

### Docker Security

- –ë–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –æ—Ç **–Ω–µ–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** `mentoriumbot:1000`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **multi-stage build** –¥–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –æ–±—Ä–∞–∑–∞
- Secrets –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è, –Ω–µ –≤ –æ–±—Ä–∞–∑

---

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Ä–µ—Å—É—Ä—Å—ã

**–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ:**
- CPU: 1 core
- RAM: 1 GB
- Disk: 10 GB

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ (100+ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π):**
- CPU: 2 cores
- RAM: 4 GB
- Disk: 50 GB (–ª–æ–≥–∏ + –±—ç–∫–∞–ø—ã)

### –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

**–¢–µ–∫—É—â–µ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ:** Polling —Ä–µ–∂–∏–º (1 —ç–∫–∑–µ–º–ø–ª—è—Ä –±–æ—Ç–∞)

**–î–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è:**
1. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ webhook-—Ä–µ–∂–∏–º
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ –∑–∞ load balancer
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Redis –¥–ª—è shared state (FSM)

---

## üéØ Roadmap

### ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (Phases 1-8)

1. ‚úÖ Database Architecture - 8 —Ç–∞–±–ª–∏—Ü, –º–∏–≥—Ä–∞—Ü–∏–∏
2. ‚úÖ AI Client - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å OpenAI
3. ‚úÖ Registration Flow - FSM, –≤–∞–ª–∏–¥–∞—Ü–∏—è email
4. ‚úÖ AI Dialogs - —Å—Ç—Ä–∏–º–∏–Ω–≥, –∫–æ–Ω—Ç–µ–∫—Å—Ç
5. ‚úÖ Reports & Notifications - –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ/–º–µ—Å—è—á–Ω—ã–µ –æ—Ç—á—ë—Ç—ã
6. ‚úÖ Billing - 3 –ø–ª–∞—Ç—ë–∂–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã, –ø–æ–¥–ø–∏—Å–∫–∏
7. ‚úÖ Monitoring - –ª–æ–≥–∏, –º–µ—Ç—Ä–∏–∫–∏, Sentry
8. ‚úÖ Production Deployment - Docker, Kubernetes

### üîÆ –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

- [ ] Admin-–ø–∞–Ω–µ–ª—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- [ ] Telegram Mini App –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- [ ] Webhook-—Ä–µ–∂–∏–º –≤–º–µ—Å—Ç–æ polling
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å email (—Ä–∞—Å—Å—ã–ª–∫–∞ –æ—Ç—á—ë—Ç–æ–≤)
- [ ] –ú–Ω–æ–≥–æ—è–∑—ã—á–Ω–æ—Å—Ç—å (uz, ru, en)
- [ ] –ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –æ—Ç—á—ë—Ç–æ–≤
- [ ] Gamification (–±–µ–π–¥–∂–∏, —Ä–µ–π—Ç–∏–Ω–≥–∏)

---

## üë• –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ handler

1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª –≤ `apps/telegram_bot/mentorium_bot/handlers/`:
```python
from aiogram import Router
from aiogram.filters import Command
from aiogram.types import Message

my_router = Router(name="my_feature")

@my_router.message(Command("mycommand"))
async def my_command_handler(message: Message):
    await message.answer("Hello!")
```

2. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –≤ `main.py`:
```python
from mentorium_bot.handlers.my_feature import my_router

dp.include_router(my_router)
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π —Ç–∞–±–ª–∏—Ü—ã

1. –°–æ–∑–¥–∞–π—Ç–µ –º–æ–¥–µ–ª—å –≤ `packages/db/mentorium_db/models.py`:
```python
class MyModel(Base):
    __tablename__ = "my_table"
    
    id = Column(Integer, primary_key=True)
    name = Column(String(100), nullable=False)
```

2. –°–æ–∑–¥–∞–π—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é:
```bash
make migrate-create MSG="add my_table"
```

3. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ:
```bash
make migrate
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `packages/db/mentorium_db/repositories/my_repo.py`:
```python
from sqlalchemy.ext.asyncio import AsyncSession
from ..models import MyModel

class MyRepository:
    def __init__(self, session: AsyncSession):
        self.session = session
    
    async def get_by_id(self, id: int) -> MyModel | None:
        return await self.session.get(MyModel, id)
```

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

- **–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:** https://github.com/taefednu/Mentorium-Chat-Bot
- **–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:** https://mentorium.uz
- **Email:** dev@mentorium.io

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

Proprietary - –≤—Å–µ –ø—Ä–∞–≤–∞ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç Mentorium Platform

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 3 –Ω–æ—è–±—Ä—è 2025

**–í–µ—Ä—Å–∏—è:** 0.1.0

**–°—Ç–∞—Ç—É—Å:** ‚úÖ Production Ready
