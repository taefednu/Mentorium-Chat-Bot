generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Learner {
  id          String   @id @default(cuid())
  firstName   String
  lastName    String
  parentEmail String
  parentChat  ParentChat?
  progress    ProgressReport[]
}

model ParentChat {
  id         String  @id
  learner    Learner @relation(fields: [learnerId], references: [id])
  learnerId  String  @unique
  createdAt  DateTime @default(now())
}

model ProgressReport {
  id          String   @id @default(cuid())
  learner     Learner  @relation(fields: [learnerId], references: [id])
  learnerId   String
  period      String
  summary     String
  strengths   String
  focusAreas  String
  milestones  String
  testResults Json
  createdAt   DateTime @default(now())
}

model SubscriptionInvoice {
  id            String   @id @default(cuid())
  parentEmail   String
  amountRub     Decimal  @db.Decimal(10, 2)
  status        InvoiceStatus @default(PENDING)
  externalRef   String?
  createdAt     DateTime @default(now())
  paidAt        DateTime?
}

enum InvoiceStatus {
  PENDING
  PAID
  FAILED
}
